<template>
 <transition enter-active-class="slideInRight">
   <div class="ifd_exploits">
        <header class="header">
            <router-link to="/ifd" slot="right">
                 <span class="back"></span>
             </router-link>
            <h2>邀请好友</h2>
        </header>

         <div class="tabbar">
            <span>账户</span>
            <span>算力</span>
            <span>挖矿量</span>
        </div>

        <div class="exploitslist">
        <p-refresh
                 v-if='flag1'
                @refresh-page='refreshpage'
                @pullup-loading='pulluploading'
                ref='refresh'
                >
              <ul class="ifd_list">
                <li v-for="(item,index) in list" :key="index">
                    <div class="list">
                        <span>{{list[index].user_mobile}}</span>
                        <span>{{list[index].user_hashrate}}</span>
                        <span>{{list[index].uc_value}}</span>
                    </div>
                </li>

            </ul>
        </p-refresh>
     </div>
   </div>
 </transition>
</template>
<script>
import {getdata} from '@/services/mining.js'
export default {
       data(){
        return{
           list:[],
           pageno:1,
           flag:true,//判断是否有数据的标识，默认有数据
           flag1:false,//数据加载完 创建滚动组件
           flag2:false,//刷新
           ganerationID:'',

        }
    },
    methods:{
        //下拉刷新
        refreshpage(){
           this.$refs.refresh.hidepullupbox();
           this.list=[];
           this.flag2=true;
           this.pageno=1;
           this.requesIncomedetails();
        },
        //上拉加载
        pulluploading(){
            this.requesIncomedetails()
        },
        //请求邀请好友数据
        requesIncomedetails(){
            this.ganerationID=this.$route.params.id
                //调用请求邀请好友数据接口
                  getdata('/users/inviteUsersDetail',{
                      token:this.$token,
                      mark:this.$mark,
                      page:this.pageno,
                      pagesize:20,
                      ganeration:this.ganerationID,
                  })
                  .then(result=>{
                      if(result.data.code==10000){
                        for(var i=0;i<result.data.result.length;i++){
                            if(!this.flag1){
                                this.list.push(result.data.result[i])
                            }
                            else if(this.flag2){
                                this.list.push(result.data.result[i])
                                this.$refs.refresh.showpullupbox();
                                this.$vux.toast.text('刷新成功');
                            }
                            else{
                                this.list.push(result.data.result[i])
                                this.$nextTick(()=>{
                                    this.$refs.refresh.refreshbox();
                                })

                            }
                        }
                        this.pageno++;
                        this.flag1=true;
                        this.flag2=false;
                      }
                      else if(result.data.code==10004){
                          this.$vux.toast.text('暂无更多数据');
                          this.$refs.refresh.pulluploading();
                      }
                      else{
                          this.$refs.refresh.pulluploading();

                      }
              })
          }
    },
    created(){
          this.requesIncomedetails();
    },
}
</script>

<style lang='less'  scoped>
 .ifd_exploits{
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;

        z-index: 0;
    }
.exploitslist{
  position: absolute;
  top: 32px;
  left: 0;
  right: 0;
  bottom: 0px;

}
.ifd_list{
      width: 100%;

      color: #9fa1b0;
      li{
          margin-top: 0.2rem;
      }
      li:last-child{
          margin-bottom: 0.2rem;
      }
  }
  .list{
      height: 2.5rem;
      width: 100%;

      display: flex;
      span{
          flex: 1;
          text-align: center;
          height: 2.5rem;
          line-height: 2.5rem;
          color: #a9acb5;
      }
  }
  .nodata{
    height: 3rem;
    position: relative;
    span{
        text-align: center;
        display: inline-block;
        width: 70%;
        height: 3rem;
        line-height: 3rem;
        color: #9fa1b0;
    }
}
.tabbar{
      position: fixed;
      top: 44px;
      width: 100%;
      height: 30px;

      color: #858891;
      font-size: 1.2rem;
      display: flex;
      border-top: 0.2rem solid black;
      z-index: 3;
      span{
          flex: 1;
          height: 30px;
          line-height: 30px;
          text-align: center;
      }
  }


</style>
